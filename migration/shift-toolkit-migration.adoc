---
sidebar: sidebar 
permalink: migration/shift-toolkit-migration.html 
keywords: netapp, vmware, esxi, vm, migration, openshift, virtualization, hyper-v, proxmox, shift, toolkit 
summary: 'Utilisez Shift Toolkit pour migrer des machines virtuelles entre plateformes de virtualisation.  Le processus comprend la préparation des machines virtuelles, la conversion des formats de disque et la configuration des paramètres réseau sur l"environnement cible.' 
---
= Migrer des machines virtuelles à l'aide de Shift Toolkit
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Utilisez Shift Toolkit pour migrer des machines virtuelles entre plateformes de virtualisation.  Le processus comprend la préparation des machines virtuelles, la conversion des formats de disque et la configuration des paramètres réseau sur l'environnement cible.



== Migrations prises en charge

Le kit d'outils Shift offre une flexibilité dans les environnements multi-hyperviseurs en prenant en charge la migration bidirectionnelle entre les hyperviseurs suivants :

* link:shift-toolkit-migrate-esxi2hyperv.html["VMware ESXi vers Microsoft Hyper-V"]
* link:shift-toolkit-migrate-hyperv2esxi.html["Migration de Microsoft Hyper-V vers VMware ESXi"]
* link:shift-toolkit-migrate-esxi2olvm.html["VMware ESXi vers Oracle Linux Virtualization Manager (OLVM)"]
* link:shift-toolkit-migrate-esxi2osv.html["Virtualisation de VMware ESXi vers Red Hat OpenShift"]




== Flux de travail de migration

Une fois le plan établi, vous pouvez lancer le processus de migration.  Lors de la migration, Shift Toolkit effectue une série d'étapes pour convertir les formats de disque et créer des machines virtuelles sur l'hôte cible, conformément au plan directeur.

L'outil Shift Toolkit effectue les étapes suivantes lors de la migration :

. Supprimer les snapshots existants pour toutes les machines virtuelles du plan
. Déclencher des instantanés de machine virtuelle pour le modèle à la source
. Déclencher un instantané du volume avant la conversion du disque
. Cloner et convertir VMDK au format VHDx pour toutes les machines virtuelles
. Mettez sous tension les machines virtuelles du groupe de protection sur la cible
. Enregistrer les réseaux sur chaque VM
. Supprimez VMware Tools et attribuez des adresses IP à l'aide de scripts de déclenchement ou de tâches cron, selon le type de système d'exploitation.




== Conseils et considérations relatifs au réseau

Lors de la planification de votre migration, tenez compte des exigences et comportements réseau suivants.  L'outil Shift Toolkit copie automatiquement les paramètres réseau des machines virtuelles sources et les réapplique aux machines virtuelles migrées, mais la dénomination des interfaces et les configurations des cartes réseau peuvent varier entre les systèmes Windows et Linux.

.Exigences générales
* Assurez-vous que des adresses IP statiques sont disponibles et non attribuées à une autre machine virtuelle.


.Machines virtuelles Windows
* Le script de préparation copie les détails de configuration réseau (espace d'adressage IP, adresse de passerelle, serveurs DNS).
* Le script de déclenchement réapplique les paramètres réseau lors de la migration pour une ou plusieurs cartes réseau, en fonction du mappage de référence.
* Après la migration, le Gestionnaire de périphériques Windows peut afficher les informations de l'ancienne carte réseau d'avant la migration, ce qui n'affecte pas la nouvelle carte ni ne provoque de conflits d'adresses IP.
* Mettez à jour vers la version 4.0 pour supprimer automatiquement les périphériques réseau orphelins du registre et du Gestionnaire de périphériques.


.Machines virtuelles Linux
* Le script de préparation copie les détails de configuration réseau (espace d'adressage IP, routes, serveurs DNS, noms des périphériques réseau).
* Le script identifie le type de réseau de la distribution Linux et applique les paramètres IP en conséquence.
* Le script de réattribution réseau est configuré comme une tâche cron via crontab et déclenché au démarrage.
* Le script réapplique les paramètres réseau pour une ou plusieurs cartes réseau en fonction du mappage de référence.


.Nomenclature des interfaces
* Les machines virtuelles converties peuvent avoir des noms d'interface comme `eth0` ou `ensp0` au lieu des noms d'interface source (par exemple, `ens192` ou `ens33` )
* Le script met à jour les détails de configuration réseau pour correspondre aux nouveaux noms d'interface.
* Si des noms prévisibles sont utilisés avec des règles de correspondance udev appropriées et que le nom de l'interface est conservé sur l'hyperviseur cible, le script ignore la configuration réseau, supprime VMware Tools et redémarre la machine virtuelle.



NOTE: L'outil Shift Toolkit permet de remplacer la préparation du réseau, permettant aux administrateurs d'exécuter des scripts personnalisés pour l'attribution d'adresses IP ou d'autres configurations.

.Mécanismes de mise en réseau pris en charge
* Gestionnaire de réseau
* Netplan
* ifconfig
* méchant


Le kit d'outils Shift conserve les adresses IP telles que spécifiées dans le plan directeur.



== Phases de migration

Voici les phases de migration que vous suivrez pour migrer des machines virtuelles à l'aide de Shift Toolkit.

. *Préparation des VM* : Préparez les VM pour la migration et vérifiez que toutes les conditions préalables sont remplies.
. *Migration et validation* : Une fois la préparation terminée, migrez les machines virtuelles VMware vers l’hyperviseur cible.
+
Une fois la migration terminée, vérifiez que les machines virtuelles démarrent correctement et que les données ont été migrées correctement.

. *Tester la migration* : Le test de migration simule la migration en convertissant le VMDK au format approprié et en créant des machines virtuelles à l’aide du fichier de disque virtuel converti sur le qtree.
+
La migration de test n'inclut pas la configuration du mappage réseau, qui doit être effectuée manuellement sur un réseau de test.




NOTE: L'outil Shift Toolkit ne modifie pas la machine virtuelle source, sauf pour copier les scripts nécessaires à sa préparation.  Cela permet une restauration rapide en cas d'échec de conversion.



== Exécuter une migration

Pour déclencher le flux de travail de migration avec la configuration spécifiée dans le plan, cliquez sur *Migrer*.

image::shift-toolkit-030.png[Boîte de dialogue montrant comment déclencher une migration de machine virtuelle]

Une fois lancé, le flux de travail s'active et le processus de conversion suit les étapes décrites pour enregistrer la machine virtuelle.  Si les machines virtuelles incluses dans le modèle ne sont pas éteintes, Shift Toolkit demande un arrêt propre avant de continuer.

image::shift-toolkit-031.png[Confirmation du processus de migration]


NOTE: NetApp recommande de ne pas déclencher plus de dix conversions en parallèle depuis la même source vers la même destination.

image::shift-toolkit-032.png[Progression de la migration]

La conversion de VMDK vers n'importe quel format de fichier s'effectue en quelques secondes, ce qui en fait l'option la plus rapide disponible.  Cette approche permet de réduire le temps d'indisponibilité des machines virtuelles pendant la migration.

image::shift-toolkit-033.png[progression de la conversion du disque]

Une fois la tâche terminée, le statut du plan passe à « Migration terminée ».

image::shift-toolkit-034.png[État de la migration terminé]
